\documentclass{../tex/report}
\usepackage{setspace} % Setting line spacing
\usepackage{ulem} % Underline
\usepackage{caption} % Captioning figures
\usepackage{subcaption} % Subfigures
\usepackage{geometry} % Page layout
\usepackage{multicol} % Columned pages
\usepackage{array,etoolbox}
\usepackage{fancyhdr}
\usepackage{enumitem}
\usepackage[toc,page]{appendix}

% Page layout (margins, size, line spacing)
\geometry{letterpaper, left=1in, right=1in, bottom=1in, top=1in}
\setstretch{1.5}

% Headers
\pagestyle{fancy}
\lhead{I\textsuperscript{2}CIP - Requirements}
\rhead{PeaPod Technologies Inc.}

% Metric counter, referencing commands
\newcounter{metricnumber}
\setcounter{metricnumber}{1}
\newcommand{\metricrow}{M\arabic{metricnumber}}
\newcommand{\mlabel}[1]{\addtocounter{metricnumber}{-1}\refstepcounter{metricnumber}\label{#1}\addtocounter{metricnumber}{1}}
\newcommand{\mref}[1]{\hyperref[#1]{M\ref{#1}}}

\begin{document}

\begin{titlepage}
    \begin{center}
        \vspace*{1.2cm}

        \textbf{\large{I\textsuperscript{2}CIP: Inter-Integrated Circuit Intra-networking Protocols}}

        \vspace{0.5cm}

        Requirements for a Hardware Design Specification for a Bus-Switched Intra-Network of Hot-Swap Modules of I\textsuperscript{2}C Targets and a Software Library of Intra-Network Communications Protocols for Rapid Implementation of Plug-and-Play Embedded Systems\\

        \vfill
        \textbf{Jayden Lefebvre - Founder \& CEO, Lead Engineer}\\
        Northumberland County, ON, Canada\\
        \vspace{.75cm}
        Primary Contact Email: \uline{contact@peapodtech.com}
        \vspace{1.25cm}

        Revision 1.0\\
        PeaPod Technologies Inc.\\
        November 2025

    \end{center}
\end{titlepage}

\thispagestyle{plain}

\tableofcontents
\newpage

\section{Introduction}\label{sec:intro}
\setstretch{1.25}

\subsection{Purpose}\label{sec:purpose}

The purpose of this document is to two-fold:

\begin{enumerate}
    \item Outline the categorical requirements (Section \ref{sec:requirements}) of an intra-network design specification for hot-swap bus-switched modules of plug-and-play I\textsuperscript{2}C devices.

    \item Detail the scoped requirements (Section \ref{sec:scope}) for the design and protocols as-proposed by PeaPod Technologies Inc., namely \textbf{I\textsuperscript{2}CIP}.
\end{enumerate}

% conditions:

% - Dynamic Routing: ***.*** This enables physical “plug-and-play” functionality.
% - Modularity: ***.*** This enables lifecycle management for physical collections of devices, and informs dynamic routing.

\clearpage

\subsection{Design Paradigm}\label{sec:paradigm}

\input{../tex/DesignParadigm.tex}

\clearpage

\subsection{Scope and Justification}\label{sec:scope}

\subsubsection{I\textsuperscript{2}C Specification}

\input{../tex/Specification.tex}

\subsubsection{OSI Model Analogue for I\textsuperscript{2}C}

\input{../tex/OSI.tex}

% TODO: WHy modules?
% TODO: Use for control systems

\clearpage

\subsubsection{Switched-Bus Intra-Networking}

\hspace{24pt} Suppose an I\textsuperscript{2}C target device $D$ with $N$ possible unique addresses. A standard I\textsuperscript{2}C bus controller $C$ can communicate with $N$ uniquely-addressed instantiations of $D$ on each I\textsuperscript{2}C bus without modification to connections or encountering conflict.

\hspace{24pt} Suppose a type of I\textsuperscript{2}C target device $X$ with $M$ possible unique addresses that acts as a multiplexer and repeater ("switch") for $B$ bitwise-enabled output busses ("subnetworks"). Using this switch device $X$, the I\textsuperscript{2}C bus controller $C$ can communicate with $M * B * N$ independently-addressable instantiations of the target device $D$ across $M * B$ subnetworks by setting ONE active output bus on each of the $M$ switches (and disabling ALL on the remaining $M - 1$).

\subsubsection{Extended OSI Model for I\textsuperscript{2}CIP}

% \hspace{24pt} Supposing $M = 8$ switches with $B = 8$ subnetworks each, the total number of uniquely-addressable instantiations of $D$ on an I\textsuperscript{2}CIP intra-network is $8 * 8 * N = 64N$, effectively enabling a 64-fold increase in independently-addressable targets of all types by a single controller.

\input{../tex/Extension.tex}

% Electrical Isolation (\textit{ISO1540})

% Unimplemented, but considered for future development:
% \begin{enumerate}[label=SC\arabic*., ref=SC\arabic*, resume]
%     \item\label{sc:6} \textbf{Presentation Layer} - Data Formatting, Data Parsing
%     \item\label{sc:7} \textbf{Application Layer} - Data Conversion, Data Processing
% \end{enumerate}

% Eight modules, eight busses per module
% "DISABLED" Bus - prevents cross-talk

\clearpage

\subsection{Definitions}\label{sec:definitions}

A number of useful definitions have emerged from the above scoping:
\begin{enumerate}
    \item \textbf{Switch}: An I\textsuperscript{2}C target device that acts as a repeater for bitwise-multiplexed output busses.
    \item \textbf{Subnetwork}: A specific output bus of a specific switch.
    \item \textbf{Intra-Network}: A general term referring to all routable targets (not including switches) on all subnetworks across all of a controller's I\textsuperscript{2}C busses.
    \item \textbf{Fully-Qualified Address (FQA)}: A unique intra-network routing location identifier, encoding: a specific I\textsuperscript{2}C bus, and; a specific subnetwork (i.e. switch and bus), and; a target's I\textsuperscript{2}C address.
    \item \textbf{Module}: A switch, and; a physical collection of targets located on the switch's subnetworks, and; a data storage target at a predetermined location with all routing information for all targets on this switch's subnetworks.
\end{enumerate}

\clearpage


\section{Framing}\label{sec:framing}

\subsection{Problem Statement}\label{sec:opportunity}

\hspace{24pt} Formulate a hardware design specification for a bus-switched intra-network of hot-swap modules of I\textsuperscript{2}C targets, and a software library of intra-network communications protocols for fully-qualified addressing and Quality-of-Service 2 packet delivery for all targets, including dedicated routing EEPROM targets for modular target lifecycle management and configuration.

\subsection{Solution Requirements}\label{sec:requirements}

% Justify:
% I2CIP MUST provide the context for the implementation for Module lifecycle management
% I2CIP MUST provide the context for the implementation for Module configuration via EEPROM
% I2CIP DOES NOT provide the implementation of Module data parsing or formatting or conversion (i.e. data is passed as-is as bytes)

The following are the overall requirements implied from scoping (Section \ref{sec:scope}) and definitions (Section \ref{sec:definitions}) of the I\textsuperscript{2}CIP design:
\begin{enumerate}[label=R\arabic*., ref=R\arabic*]
    \item\label{r:1} \textbf{Must} include a hardware design specification of an I\textsuperscript{2}C intra-network that:
    \begin{enumerate}[ref=R1\alph*]
        \item\label{r:1a} \textbf{Must} implement switching of output bus subnetworks while preventing cross-talk;
        \item\label{r:1b} \textbf{Must} implement hot-swap capability;
        \item\label{r:1c} \textbf{Must} implement dedicated routing EEPROM targets;
    \end{enumerate}
    \item\label{r:2} \textbf{Must} include a software library for operating the I\textsuperscript{2}C intra-network that:
    \begin{enumerate}[ref=R2\alph*]
        \item\label{r:2a} \textbf{Must} implement fully-qualified addressing encoding routing information for any target on any subnetworks across all I\textsuperscript{2}C busses;
        \item\label{r:2b} \textbf{Must} implement Quality-of-Service 2 packet delivery for all communications across the intra-network;
        \item\label{r:2c} \textbf{Must} implement plug-and-play modular target lifecycle management via dedicated routing EEPROM targets;
    \end{enumerate}
    \item\label{r:3} \textbf{Should} support multiple I\textsuperscript{2}C bus controllers.
    \item\label{r:4} \textbf{Should} implement electrical isolation for all targets on all subnetworks.
\end{enumerate}

% Change line spacing for the more list-heavy sections
\setstretch{1}
\subsection{Stakeholders and Values}\label{sec:stakeholders}

\begin{enumerate}[label=S\arabic*., ref=S\arabic*]
    \item\label{s:1} Embedded Systems Designers - Modularity, Scalability
    \item\label{s:2} System End-Users - Reliability, Maintainability
    \item \label{s:3} Hobbyists, Makers, Educators - Accessibility
\end{enumerate}

\clearpage

\subsection{Problem-Solving Goals}\label{sec:goals}

% High-Level
\begin{multicols}{2}[]
    \begin{enumerate}[label=HL\arabic*., ref=HL\arabic*]
        \item\label{hl:modularity} Modularity, Scalability \hfill (\ref{s:1},~\ref{r:1a})
        \item\label{hl:stability} Reliability, Stability \hfill (\ref{s:2},~\ref{r:1a},~\ref{r:1b},~\ref{r:2b},~\ref{r:2c})
    \end{enumerate}
\end{multicols}

\subsection{Solution Objectives}\label{sec:objectives}

% Low-Level
\begin{multicols}{2}[]
    \begin{enumerate}[label=LL\arabic*., ref=LL\arabic*]
        \item\label{ll:hotswap} Hot-Swappability \hfill (\ref{hl:modularity})
        \item\label{ll:plugandplay} Plug-and-Play \hfill (\ref{hl:modularity},~\ref{s:3},~\ref{r:2c})
    \end{enumerate}
\end{multicols}

\clearpage


\subsection{Metrics}\label{sec:metrics}

\begin{tabular}{| @{\makebox[2.4em][c]{\metricrow}} | p{8.7cm} | p{5.9cm} |} 
    \hline
    \multicolumn{1}{| @{\makebox[2.4em][c]{\textbf{\#}}} | l |}{\textbf{Metric}} & \textbf{Units}\\ 
    \hline
    Targets Hot-Swappable \mlabel{m:hotswap} \hfill (\ref{ll:hotswap}) & Yes/No \\
    Modules Plug-and-Play \mlabel{m:plugandplay} \hfill (\ref{ll:plugandplay}) & Yes/No \\
    \hline
\end{tabular}


\subsection{Constraints}\label{sec:constraints}

\begin{tabular}{|l|p{14.35cm}|}
    \hline
    \textbf{Metric} & \textbf{Constraint \hfill Justification} \\
    \hline
    \mref{m:hotswap} & Yes \hfill (\ref{r:1b})\\ \hline
    \mref{m:plugandplay} & Yes \hfill (\ref{r:2c})\\ \hline
\end{tabular}

\subsection{Criteria}\label{sec:criteria}

\begin{tabular}{|l|p{14.35cm}|}
    \hline
    \textbf{Metric} & \textbf{Criteria \hfill Justification} \\
    \hline
    % \mref{m:criteria} & Should Maximize \hfill (\ref{r:1a}) \\
    \hline
\end{tabular}

% Refer to Appendix \ref{sec:assessment} for prototype verification Assessment Criteria (categories, weights, etc.).

\newpage

\section{Reference Designs}

% -------- TEMPLATE --------
% Introduction - Project goal, scope, differences from this project
% Graphics - Design drawings/photos, etc.
% Analysis - Rank the design across each of our metrics
    % TODO: Metrics might be too much, maybe just qualitative analysis based on LLOs?

\subsection{Reference Design XYZ}

Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed auctor, nunc nec ultricies ultricies, nunc nunc ultricies nunc, nec ultricies nunc nunc nec.

% \newpage

% % References
% \bibliographystyle{IEEEtran}
% \bibliography{references}

\end{document}